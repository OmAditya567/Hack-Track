<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>hack2travel - Kerala Planner</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- API KEY & MOCK DATA ---
        /*
         * ‚ùó‚ùó‚ùó IMPORTANT ‚ùó‚ùó‚ùó
         * The Weather Widget uses a key for WeatherAPI.com.
         * You can get a FREE key from https://www.weatherapi.com/
         * Then, replace the placeholder key below with your actual key.
         */
        const API_KEY = 'a7203ef8bd8e46a9bf5145019250609'; 

        const destinations = {
            'kerala': {
                name: 'Kerala, India',
                description: 'Often called "God\'s Own Country", Kerala is a serene paradise known for its palm-lined beaches, tranquil backwaters, lush tea plantations, and vibrant cultural traditions like Kathakali and Theyyam.',
                images: [
                    'https://images.unsplash.com/photo-1602216056096-3b40cc0c9944?q=80&w=2070&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1593693397640-05247e33734a?q=80&w=2070&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1588623692369-993b2539a291?q=80&w=2070&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1616191122373-6c61f385c5a7?q=80&w=1974&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1579751626652-59842a2353a2?q=80&w=1974&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1614552554235-97a24330c5e3?q=80&w=2070&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1549363520-49348e65a6e3?q=80&w=1964&auto=format&fit=crop',
                    'https://images.unsplash.com/photo-1598135753163-6167c1a1ad25?q=80&w=2070&auto=format&fit=crop'
                ],
                mostVisited: { name: 'Alleppey (Alappuzha) Backwaters', icon: 'üõ∂', details: 'Experience the heart of Kerala by cruising its enchanting backwaters on a traditional houseboat. It\'s an unforgettable journey through a network of lakes, canals, and lagoons.' },
                attractions: [
                    { name: 'Munnar Tea Gardens', icon: 'üçÉ', details: 'Wander through emerald-green tea estates covering rolling hills.', coords: [10.0892, 77.0595], reviews: [{name: 'Rohan', rating: 5, comment: 'Breathtakingly beautiful!'}, {name: 'Priya', rating: 4, comment: 'A must-visit for nature lovers.'}] },
                    { name: 'Fort Kochi', icon: 'üï∏', details: 'Historic area with iconic Chinese fishing nets and colonial architecture.', coords: [9.9656, 76.2425], reviews: [{name: 'Alisha', rating: 5, comment: 'Loved the vibe and the history.'}] },
                    { name: 'Periyar National Park, Thekkady', icon: 'üêò', details: 'A wildlife sanctuary famous for elephants, tigers, and spice plantations.', coords: [9.4678, 77.1444], reviews: [{name: 'David', rating: 4, comment: 'Saw elephants by the lake!'}, {name: 'Sunita', rating: 4, comment: 'The boat ride was amazing.'}] },
                    { name: 'Varkala Beach', icon: 'üèñ', details: 'A stunning cliffside beach offering panoramic views of the Arabian Sea.', coords: [8.7383, 76.7161], reviews: [{name: 'Chloe', rating: 5, comment: 'The cliff view is unreal.'}] },
                    { name: 'Edakkal Caves, Wayanad', icon: 'üèû', details: 'Prehistoric caves with ancient petroglyphs, offering a trek back in time.', coords: [11.6214, 76.2361], reviews: [{name: 'Arjun', rating: 4, comment: 'The trek up is worth it for the history.'}] },
                    { name: 'Chembra Peak, Wayanad', icon: '‚õ∞', details: 'Trek to the stunning heart-shaped lake near the top of Wayanad\'s highest peak.', coords: [11.5222, 76.0833], reviews: [{name: 'Vikram', rating: 5, comment: 'A challenging but rewarding trek.'}] }
                ],
                restaurants: [
                    { name: 'Paragon, Kozhikode', type: 'üå∂ Malabar Cuisine', details: 'A legendary restaurant famous for its authentic Malabar Biryani.', coords: [11.2588, 75.7804], reviews: [{name: 'Zain', rating: 5, comment: 'Best biryani I have ever had, period.'}, {name: 'Maria', rating: 5, comment: 'An absolute must-visit.'}] },
                    { name: 'Villa Maya, Trivandrum', type: 'üèõ Fine Dining', details: 'A restored 18th-century Dutch manor serving exquisite Indian and continental cuisine.', coords: [8.4819, 76.9431], reviews: [{name: 'James', rating: 5, comment: 'Incredible ambiance and food.'}] },
                    { name: 'Grand Pavilion, Kochi', type: 'üè® Classic Keralan', details: 'Known for its Syrian Christian delicacies and old-world charm.', coords: [9.9816, 76.2999], reviews: [{name: 'Anjali', rating: 4, comment: 'Authentic Kerala food. Great taste.'}] },
                    { name: 'Dhe Puttu, Kochi', type: 'üçö Puttu Specialist', details: 'Celebrity-owned restaurant serving a wide variety of "puttu" (steamed rice cake).', coords: [9.9976, 76.2974], reviews: [{name: 'Sam', rating: 4, comment: 'So many varieties of puttu to try!'}] },
                    { name: 'Kayees Rahmathulla Cafe, Kochi', type: 'üçö Biryani', details: 'An iconic eatery renowned for its delicious and aromatic mutton biryani.', coords: [9.9650, 76.2570], reviews: [{name: 'Faisal', rating: 5, comment: 'The biryani is legendary for a reason.'}] }
                ],
                hiddenGems: [
                    { name: 'Marari Beach', icon: 'üå¥', details: 'A quiet and pristine beach, perfect for relaxation away from the crowds.', coords: [9.5941, 76.3216] },
                    { name: 'Vagamon', icon: 'üå≤', details: 'A sleepy hill station with pine forests, meadows, and cascading waterfalls.', coords: [9.6845, 76.9033] },
                    { name: 'Kolukkumalai Tea Estate', icon: 'üåÑ', details: 'The world\'s highest organic tea plantation, offering breathtaking sunrise views.', coords: [9.9679, 77.1065] },
                    { name: 'Poovar Island', icon: 'üèù', details: 'A beautiful estuary where a river, lake, and the sea meet, creating a unique ecosystem.', coords: [8.3150, 77.0700] },
                    { name: 'Silent Valley National Park', icon: 'ü¶ã', details: 'A pristine, untouched rainforest, core of the Nilgiri Biosphere Reserve.', coords: [11.1309, 76.4326]},
                    { name: 'Kerala Folklore Museum', icon: 'üèõ', details: 'A treasure trove of architectural and cultural artifacts in Kochi.', coords: [9.9328, 76.3033]}
                ],
                 localFoods: [
                    { name: 'Puttu & Kadala Curry', type: 'Breakfast', description: 'A quintessential Kerala breakfast. Puttu is a steamed cylinder of ground rice layered with coconut shavings. It is served with Kadala Curry, a flavorful black chickpea curry.', ingredients: ['Rice flour', 'Grated coconut', 'Black chickpeas', 'Onion', 'Tomato', 'Spices'] },
                    { name: 'Appam & Stew', type: 'Breakfast / Dinner', description: 'Appam is a soft, fluffy pancake made from fermented rice batter, with a crispy lace-like edge. It is typically paired with a creamy stew made with coconut milk, vegetables, or meat.', ingredients: ['Rice', 'Coconut', 'Yeast', 'Mixed vegetables/Chicken', 'Coconut milk', 'Spices'] },
                    { name: 'Idiyappam (Noolappam)', type: 'Breakfast / Dinner', description: 'Also known as string hoppers, Idiyappam is made from rice flour pressed into noodle form and then steamed. It\'s light, delicate, and served with curries or sweetened coconut milk.', ingredients: ['Rice flour', 'Grated coconut', 'Salt'] },
                    { name: 'Malabar Parotta & Beef Fry', type: 'Lunch / Dinner', description: 'A layered flatbread made from maida flour, known for its flaky, crispy texture. It is famously paired with a spicy and aromatic beef fry, a dry preparation of beef cooked with spices.', ingredients: ['All-purpose flour (Maida)', 'Beef', 'Onion', 'Ginger-garlic paste', 'Spices', 'Coconut oil'] },
                    { name: 'Kerala Sadya', type: 'Feast', description: 'A grand vegetarian feast served on a banana leaf, featuring a variety of dishes. It includes rice, pickles, pappadam, and a wide range of curries like Sambar, Avial, and Thoran.', ingredients: ['Rice', 'Lentils', 'Assorted vegetables', 'Coconut', 'Yogurt', 'Tamarind', 'Spices'] },
                    { name: 'Karimeen Pollichathu', type: 'Main Course (Seafood)', description: 'Pearl spot fish (Karimeen) is marinated in a spicy masala paste, wrapped in a banana leaf, and then steamed or grilled. The leaf imparts a unique aroma to the fish.', ingredients: ['Pearl spot fish', 'Onion', 'Tomato', 'Chilli powder', 'Turmeric', 'Banana leaf'] },
                    { name: 'Thalassery Biryani', type: 'Main Course', description: 'A famous biryani from the Malabar region, made with a special short-grain rice called Kaima rice. It has a unique aroma from the blend of spices and is layered with fried chicken or mutton.', ingredients: ['Kaima rice', 'Chicken/Mutton', 'Onion', 'Ghee', 'Saffron', 'Biryani masala'] },
                    { name: 'Pazham Pori', type: 'Snack', description: 'A beloved evening snack, also known as Ethakka Appam. Ripe plantain slices are coated in a flour batter and deep-fried until golden brown.', ingredients: ['Ripe plantains', 'All-purpose flour', 'Rice flour', 'Turmeric', 'Sugar'] },
                    { name: 'Ada Pradhaman', type: 'Dessert', description: 'A traditional Kerala dessert or payasam. It consists of rice pasta flakes (ada) cooked in a sweet and creamy coconut milk and jaggery sauce, flavored with cardamom and nuts.', ingredients: ['Rice ada', 'Jaggery', 'Coconut milk', 'Cardamom', 'Cashews', 'Ghee'] },
                    { name: 'Ven Pongal', type: 'Breakfast', description: 'A savory South Indian porridge made with rice and yellow moong dal, cooked to a creamy consistency. It is tempered with ghee, black pepper, cumin, and cashews.', ingredients: ['Rice', 'Moong dal', 'Ghee', 'Black peppercorns', 'Cumin seeds', 'Cashews'] },
                    { name: 'Medu Vada', type: 'Snack / Breakfast', description: 'A popular savory fritter shaped like a doughnut. It is made from a batter of urad dal (black lentils), has a crispy exterior and a soft, fluffy interior, often served with sambar and chutney.', ingredients: ['Urad dal', 'Onion', 'Green chillies', 'Ginger', 'Curry leaves'] }
                ],
                activityPool: {
                    'Kochi': [ { text: 'Explore Fort Kochi & Chinese Fishing Nets.', tags: ['Culture', 'History', 'Photography'], coords: [9.9656, 76.2425] }, { text: 'Visit Mattancherry Palace & Paradesi Synagogue.', tags: ['History', 'Culture'], coords: [9.9583, 76.2597] }, { text: 'Stroll through Jew Town for antiques.', tags: ['Shopping', 'Culture', 'History'], coords: [9.9575, 76.2594] }, { text: 'Watch a Kathakali dance performance.', tags: ['Art & Music', 'Culture'], coords: [9.9678, 76.2415] }, { text: 'Discover the street art of Fort Kochi.', tags: ['Art & Music', 'Photography', 'Culture'], coords: [9.9656, 76.2425] }, { text: 'Go on a culinary tour of local eateries.', tags: ['Foodie', 'Culture'], coords: [9.9650, 76.2570] }, { text: 'Shop for spices and souvenirs at Broadway.', tags: ['Shopping', 'Foodie'], coords: [9.9816, 76.2792] }, { text: 'Visit the Kerala Folklore Museum.', tags: ['History', 'Culture', 'Art & Music'], isGem: true, coords: [9.9328, 76.3033] }, { text: 'Witness Onam or Christmas celebrations (seasonal).', tags: ['Festivals', 'Culture'], coords: [9.9678, 76.2415] } ],
                    'Munnar': [ { text: 'Walk through tea plantations & visit a museum.', tags: ['Nature', 'Relaxation', 'Photography'], coords: [10.0892, 77.0595] }, { text: 'Visit Top Station for panoramic views.', tags: ['Nature', 'Trekking', 'Photography'], coords: [10.1345, 77.2418] }, { text: 'Explore Eravikulam National Park (Nilgiri Tahr).', tags: ['Wildlife', 'Nature', 'Adventure'], coords: [10.1565, 77.0558] }, { text: 'See Mattupetty Dam and enjoy a boat ride.', tags: ['Nature', 'Relaxation'], coords: [10.1067, 77.1299] }, { text: 'Take a Jeep safari to Kolukkumalai Tea Estate.', tags: ['Adventure', 'Nature', 'Photography', 'Trekking'], isGem: true, coords: [9.9679, 77.1065] }, { text: 'Go bird watching at the Salim Ali Bird Sanctuary.', tags: ['Wildlife', 'Nature'], coords: [10.0210, 76.7118] }, { text: 'Enjoy a peaceful Shikara ride on Kundala Lake.', tags: ['Relaxation', 'Nature'], coords: [10.1292, 77.1683] }, { text: 'Buy fresh tea and local spices.', tags: ['Shopping', 'Foodie'], coords: [10.0889, 77.0597] } ],
                    'Thekkady': [ { text: 'Take a boat safari on Periyar Lake.', tags: ['Wildlife', 'Nature', 'Adventure'], coords: [9.4678, 77.1444] }, { text: 'Go on a guided spice plantation tour.', tags: ['Foodie', 'Culture', 'Nature'], coords: [9.5828, 77.0322] }, { text: 'Watch a Kalaripayattu martial arts show.', tags: ['Adventure', 'Culture'], coords: [9.5989, 77.0396] }, { text: 'Discover the misty hills and meadows of Vagamon.', tags: ['Nature', 'Relaxation', 'Trekking', 'Photography'], isGem: true, coords: [9.6845, 76.9033] }, { text: 'Take a Keralan cuisine cooking class.', tags: ['Foodie', 'Culture'], coords: [9.5989, 77.0396] }, { text: 'Participate in a night patrol in the jungle.', tags: ['Adventure', 'Wildlife'], coords: [9.4678, 77.1444] }, { text: 'Hike through Silent Valley National Park.', tags: ['Wildlife', 'Nature', 'Trekking', 'Adventure'], isGem: true, coords: [11.1309, 76.4326] }, { text: 'Learn about medicinal plants and Ayurveda.', tags: ['Ayurveda', 'Nature'], coords: [9.5828, 77.0322] } ],
                    'Alleppey': [ { text: 'Spend a day/night on a traditional houseboat.', tags: ['Relaxation', 'Culture', 'Nature'], coords: [9.5034, 76.3314] }, { text: 'Enjoy authentic Keralan meals on the boat.', tags: ['Foodie', 'Culture'], coords: [9.5034, 76.3314] }, { text: 'Witness village life along the backwaters.', tags: ['Culture', 'Photography'], coords: [9.5034, 76.3314] }, { text: 'Unwind on the pristine sands of Marari Beach.', tags: ['Beaches', 'Relaxation', 'Photography'], isGem: true, coords: [9.5941, 76.3216] }, { text: 'Explore the backwaters by kayak.', tags: ['Adventure', 'Nature'], coords: [9.5034, 76.3314] }, { text: 'Relax and watch the sunset over the water.', tags: ['Relaxation', 'Photography'], coords: [9.4981, 76.3328] }, { text: 'Watch a snake boat race (seasonal).', tags: ['Festivals', 'Adventure', 'Culture'], coords: [9.4981, 76.3328] }, { text: 'Stay at an Ayurveda and wellness retreat.', tags: ['Ayurveda', 'Relaxation', 'Spirituality'], coords: [9.5941, 76.3216] } ],
                    'Varkala/Kovalam': [ { text: 'Relax on the cliffside Varkala or Kovalam beaches.', tags: ['Beaches', 'Relaxation'], coords: [8.7383, 76.7161] }, { text: 'Visit the Janardhana Swamy Temple.', tags: ['Spirituality', 'Culture'], coords: [8.7346, 76.7143] }, { text: 'Enjoy swimming, sunbathing, and watersports.', tags: ['Beaches', 'Adventure'], coords: [8.4021, 76.9781] }, { text: 'Experience a rejuvenating Ayurvedic massage.', tags: ['Ayurveda', 'Relaxation'], coords: [8.7383, 76.7161] }, { text: 'Try surfing or stand-up paddleboarding.', tags: ['Adventure', 'Beaches'], coords: [8.7383, 76.7161] }, { text: 'Practice yoga at a cliffside wellness center.', tags: ['Spirituality', 'Relaxation', 'Ayurveda'], coords: [8.7383, 76.7161] }, { text: 'Explore the unique Poovar Island estuary.', tags: ['Nature', 'Beaches', 'Relaxation'], isGem: true, coords: [8.3150, 77.0700] }, { text: 'Visit Napier Museum & Zoo in nearby Trivandrum.', tags: ['History', 'Art & Music', 'Wildlife', 'Culture'], coords: [8.5097, 76.9535] } ],
                    'Wayanad': [ { text: 'Trek to Chembra Peak and see the heart-shaped lake.', tags: ['Trekking', 'Nature', 'Adventure', 'Photography'], coords: [11.5222, 76.0833] }, { text: 'Explore the prehistoric Edakkal Caves.', tags: ['History', 'Adventure', 'Trekking'], coords: [11.6214, 76.2361] }, { text: 'Visit the stunning Soochipara Waterfalls.', tags: ['Nature', 'Adventure', 'Relaxation', 'Photography'], coords: [11.4580, 76.1150] }, { text: 'Go boating at the serene Pookode Lake.', tags: ['Nature', 'Relaxation'], coords: [11.5434, 76.0305] }, { text: 'Visit a local tribal village to learn their heritage.', tags: ['Culture', 'History'], coords: [11.7589, 76.0833] }, { text: 'Witness a Theyyam performance (seasonal).', tags: ['Festivals', 'Culture', 'Spirituality', 'Photography'], coords: [11.7589, 76.0833] }, { text: 'Shop for local honey and handicrafts.', tags: ['Shopping', 'Foodie'], coords: [11.6095, 76.1311] }, { text: 'Watch a Mohiniyattam dance recital.', tags: ['Art & Music', 'Culture', 'Festivals'], coords: [11.6095, 76.1311] } ]
                },
                locationDetails: {
                    'Kochi': { a: true, s: true, c: 'High', t: 'Urban', d: 'City center itself' },
                    'Munnar': { a: true, s: true, c: 'Medium', t: 'Rural/Town', d: '~110 km from Kochi' },
                    'Thekkady': { a: true, s: true, c: 'Medium', t: 'Rural/Town', d: '~140 km from Munnar' },
                    'Alleppey': { a: true, s: true, c: 'Medium', t: 'Urban/Backwaters', d: '~155 km from Thekkady' },
                    'Varkala/Kovalam': { a: true, s: true, c: 'Medium', t: 'Coastal Town', d: '~160 km from Alleppey' },
                    'Wayanad': { a: true, s: true, c: 'Low', t: 'Rural/Hilly', d: '~270 km from Kochi' }
                },
                activities: [
                    { category: 'Water Sports', icon: 'üåä', list: [ { name: 'Houseboat Cruise', location: 'Alleppey Backwaters' }, { name: 'Kayaking & Canoeing', location: 'Alleppey, Poovar' }, { name: 'Bamboo Rafting', location: 'Periyar Lake, Thekkady' }, { name: 'Surfing', location: 'Varkala Beach' } ] },
                    { category: 'Trekking & Hiking', icon: 'ü•æ', list: [ { name: 'Chembra Peak Trek', location: 'Wayanad' }, { name: 'Kolukkumalai Tea Estate Trek', location: 'Near Munnar' }, { name: 'Top Station Trek', location: 'Munnar' }, { name: 'Edakkal Caves Hike', location: 'Wayanad' } ] },
                    { category: 'Wildlife Safaris', icon: 'üêò', list: [ { name: 'Boat Safari', location: 'Periyar National Park, Thekkady' }, { name: 'Jeep Safari', location: 'Eravikulam National Park, Munnar' }, { name: 'Jungle Night Patrol', location: 'Thekkady (with guides)' } ] },
                    { category: 'Cultural Experiences', icon: 'üé≠', list: [ { name: 'Kathakali Performance', location: 'Fort Kochi' }, { name: 'Kalaripayattu Show', location: 'Thekkady' }, { name: 'Theyyam Ritual (Seasonal)', location: 'Northern Kerala (Kannur)' }, { name: 'Spice Plantation Tour', location: 'Thekkady, Munnar' } ] }
                ],
                festivals: [
                    { name: 'Onam', slogan: 'The Harvest Festival of Kerala', time: 'August/September', places: 'Celebrated statewide, especially vibrant in Thrissur, Kochi, and Trivandrum.' },
                    { name: 'Thrissur Pooram', slogan: 'The Mother of All Festivals', time: 'April/May', places: 'Vadakkunnathan Temple, Thrissur. A grand spectacle of elephants, music, and fireworks.' },
                    { name: 'Nehru Trophy Boat Race', slogan: 'The Olympics of the Backwaters', time: '2nd Saturday of August', places: 'Punnamada Lake, Alleppey. A thrilling snake boat race.' },
                    { name: 'Theyyam', slogan: 'The Dance of the Gods', time: 'December to April', places: 'Various temples in Northern Kerala, especially Kannur and Kasaragod districts.' }
                ],
                tourPackages: [
                    { name: 'Honeymoon Escape', description: 'A romantic journey through misty hills and serene backwaters.', days: 7, interests: ['Relaxation', 'Nature'] },
                    { name: 'Adventure Seeker', description: 'An action-packed trip for thrill-seekers, from trekking to wildlife safaris.', days: 6, interests: ['Adventure', 'Trekking', 'Wildlife'] },
                    { name: 'Cultural Explorer', description: 'Immerse yourself in the rich history, art, and traditions of Kerala.', days: 5, interests: ['Culture', 'History', 'Art & Music'] },
                    { name: 'Foodie Delight', description: 'A culinary tour to taste the diverse and delicious flavors of Kerala cuisine.', days: 4, interests: ['Foodie', 'Culture'] }
                ],
                emergencyInfo: { 
                    general: '112', police: '100', ambulance: '102', fire: '101', disasterManagement: '1077',
                    hospitals: [
                        { name: 'Aster Medcity, Kochi', coords: [10.0545, 76.3220] },
                        { name: 'Lakeshore Hospital, Kochi', coords: [9.9079, 76.3361] },
                        { name: 'KIMS Hospital, Trivandrum', coords: [8.5306, 76.9133] },
                        { name: 'Baby Memorial Hospital, Kozhikode', coords: [11.2465, 75.8016]}
                    ],
                    pharmacies: [
                        { name: 'Apollo Pharmacy, MG Road, Kochi', coords: [9.9763, 76.2895] },
                        { name: 'MedPlus Pharmacy, Trivandrum', coords: [8.5135, 76.9442] },
                        { name: 'Neethi Medical Store, Kozhikode', coords: [11.2588, 75.7804]}
                    ]
                },
                packingList: { 'Essentials': ['Passport/ID', 'Visa', 'Tickets', 'Cash/Cards', 'Phone & Charger'], 'Clothing': ['Light Cottons', 'Swimwear', 'Rain Jacket', 'Shawl/Jacket', 'Modest Clothes (Temples)'], 'Footwear': ['Sandals/Flip-flops', 'Walking Shoes', 'Water Shoes'], 'Health': ['First-Aid Kit', 'Insect Repellent', 'Sunscreen', 'Hand Sanitizer', 'Personal Meds'], 'Miscellaneous': ['Power Bank', 'Universal Adapter', 'Camera', 'Water Bottle', 'Sunglasses'] }
            }
        };
        const translations = { 'hello': 'Namaskaram', 'thank you': 'Nandi', 'yes': 'Athe', 'no': 'Illa', 'how much?': 'Ethrayanu?', 'water': 'Vellam', 'food': 'Bhaskhanam', 'goodbye': 'Pinne kaanam' };
        const interests = ['Adventure', 'Beaches', 'Culture', 'Foodie', 'History', 'Nature', 'Relaxation', 'Wildlife', 'Spirituality', 'Shopping', 'Trekking', 'Ayurveda', 'Art & Music', 'Festivals', 'Photography'];
        
        const generateItinerary = (activityPool, days, selectedInterests) => {
            const itinerary = [];
            const allLocations = Object.keys(activityPool);
            let customRoute = [];
            if (selectedInterests.length === 0) {
                customRoute = ['Kochi', 'Munnar', 'Thekkady', 'Alleppey', 'Varkala/Kovalam', 'Wayanad'];
            } else {
                const scoredLocations = allLocations.map(location => {
                    const activities = activityPool[location];
                    const locationScore = activities.reduce((totalScore, activity) => totalScore + activity.tags.reduce((score, tag) => score + (selectedInterests.includes(tag) ? 1 : 0), 0), 0);
                    return { location, score: locationScore };
                }).filter(item => item.score > 0).sort((a, b) => b.score - a.score);
                customRoute = scoredLocations.map(item => item.location);
                const remainingLocations = allLocations.filter(loc => !customRoute.includes(loc));
                customRoute = [...customRoute, ...remainingLocations];
            }
            const dayAllocation = {};
            for (let i = 0; i < days; i++) {
                const locationForDay = customRoute[i % customRoute.length];
                dayAllocation[locationForDay] = (dayAllocation[locationForDay] || 0) + 1;
            }
            let dayCounter = 1;
            for (const location of customRoute) {
                if (dayAllocation[location]) {
                    const numDaysInLocation = dayAllocation[location];
                    for (let i = 0; i < numDaysInLocation; i++) {
                        if (dayCounter > days) break;
                        const allActivitiesForLocation = activityPool[location] || [];
                        let chosenActivities = [];
                        if (allActivitiesForLocation.length > 0) {
                            const sortedActivities = allActivitiesForLocation
                                .map(activity => ({ ...activity, score: activity.tags.reduce((acc, tag) => acc + (selectedInterests.includes(tag) ? 1 : 0), 0) + (activity.isGem && selectedInterests.length > 0 ? 1 : 0) }))
                                .sort((a, b) => b.score - a.score);
                            const activityOffset = i * 3;
                            chosenActivities = sortedActivities.slice(activityOffset, activityOffset + 3);
                            if(chosenActivities.length === 0) chosenActivities = sortedActivities.slice(0, 3);
                        }
                       itinerary.push({ 
                           day: `Day ${dayCounter}: ${location}`, 
                           location: location,
                           activities: chosenActivities.length > 0 ? chosenActivities : [{text: "Relax and explore the local area."}] 
                       });
                       dayCounter++;
                    }
                }
            }
            return itinerary;
        };
        
        function PhotoGallery({ images }) {
            const [currentIndex, setCurrentIndex] = React.useState(0);
            const goToPrevious = () => { const isFirstSlide = currentIndex === 0; const newIndex = isFirstSlide ? images.length - 1 : currentIndex - 1; setCurrentIndex(newIndex); };
            const goToNext = () => { const isLastSlide = currentIndex === images.length - 1; const newIndex = isLastSlide ? 0 : currentIndex + 1; setCurrentIndex(newIndex); };
            return (
                <div className="h-full w-full relative group">
                    <div style={{ backgroundImage: `url(${images[currentIndex]})`}} className="w-full h-full rounded-xl bg-center bg-cover duration-500"></div>
                    <div onClick={goToPrevious} className="hidden group-hover:block absolute top-[50%] -translate-y-[-50%] left-5 text-2xl rounded-full p-2 bg-black/20 text-white cursor-pointer">‚ùÆ</div>
                    <div onClick={goToNext} className="hidden group-hover:block absolute top-[50%] -translate-y-[-50%] right-5 text-2xl rounded-full p-2 bg-black/20 text-white cursor-pointer">‚ùØ</div>
                    <div className="flex top-4 justify-center py-2 absolute bottom-4 left-0 right-0">
                        {images.map((_, slideIndex) => (
                            <div key={slideIndex} onClick={() => setCurrentIndex(slideIndex)} className={`text-2xl cursor-pointer transition-all mx-1 ${currentIndex === slideIndex ? 'text-white' : 'text-white/50'}`}>‚óè</div>
                        ))}
                    </div>
                </div>
            );
        }

        function LoadingSpinner() {
            return (
                <div className="flex justify-center items-center h-full">
                    <svg className="animate-spin h-10 w-10 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                        <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </div>
            );
        }

        const getWeatherEmoji = (conditionText) => {
            const text = conditionText.toLowerCase();
            if (text.includes('thunder')) return '‚õà';
            if (text.includes('drizzle') || text.includes('light rain')) return 'üå¶';
            if (text.includes('rain')) return 'üåß';
            if (text.includes('snow') || text.includes('sleet')) return '‚ùÑÔ∏è';
            if (text.includes('mist') || text.includes('fog')) return 'üå´Ô∏è';
            if (text.includes('clear') || text.includes('sunny')) return '‚òÄÔ∏è';
            if (text.includes('partly cloudy')) return 'üå§Ô∏è';
            if (text.includes('cloudy') || text.includes('overcast')) return '‚òÅÔ∏è';
            return 'üåç';
        };

        function WeatherWidget({ location }) {
            const { useState, useEffect } = React;
            const [weather, setWeather] = useState(null);
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);
            
            useEffect(() => {
                if (!location || API_KEY === 'YOUR_API_KEY_HERE') { 
                    setError({ message: "API key not configured."}); 
                    setIsLoading(false); 
                    return; 
                };
                setIsLoading(true);
                fetch(`https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${location},India`)
                    .then(response => response.json())
                    .then(data => { 
                        if (data.error) { throw new Error(data.error.message); }
                        setWeather(data); 
                        setIsLoading(false);
                    })
                    .catch(error => { setError(error); setIsLoading(false); });
            }, [location]);

            const renderContent = () => {
                if (isLoading) return <p className="text-sm">Loading weather...</p>;
                if (error) return <p className="text-sm text-amber-600 dark:text-amber-500">Weather unavailable</p>;
                if (!weather) return null;
                
                return (
                    <div className="flex items-center gap-3">
                        <span className="text-2xl">{getWeatherEmoji(weather.current.condition.text)}</span>
                        <div className="flex flex-col text-sm">
                           <span className="font-semibold">{Math.round(weather.current.temp_c)}¬∞C</span>
                           <span className="text-xs capitalize">{weather.current.condition.text}</span>
                        </div>
                    </div>
                );
            };
            return <div className="mt-4 pt-4 border-t border-black/10 dark:border-white/10">{renderContent()}</div>
        }
        
        function MapComponent({ places }) {
            const mapRef = React.useRef(null);
            React.useEffect(() => {
                if (mapRef.current === null) {
                    mapRef.current = L.map('map-container').setView([10.8505, 76.2711], 7);
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
                    }).addTo(mapRef.current);
                }
                const markers = L.layerGroup();
                places.forEach(place => {
                    if (place.coords) {
                        const popupContent = `
                            <div style="font-family: Inter, sans-serif; text-align: center;">
                                <strong style="font-size: 1.1em;">${place.name}</strong>
                                <br/>
                                <a href="https://www.google.com/maps/dir/?api=1&destination=${place.coords[0]},${place.coords[1]}" target="_blank" rel="noopener noreferrer" style="color: #4f46e5; font-weight: 600; text-decoration: none; font-size: 0.9em; display: inline-block; margin-top: 5px;">
                                    Get Directions ‚Üí
                                </a>
                            </div>`;
                        L.marker(place.coords).bindPopup(popupContent).addTo(markers);
                    }
                });
                markers.addTo(mapRef.current);
                return () => { markers.clearLayers(); };
            }, [places]);
            return <div id="map-container" className="shadow-lg" style={{ height: '400px', width: '100%', borderRadius: '12px', zIndex: 0 }}></div>;
        }
        
        function StarRating({ rating }) {
            const totalStars = 5;
            const fullStars = Math.floor(rating);
            const emptyStars = totalStars - fullStars;
            return (
                <div className="flex items-center">
                    {[...Array(fullStars)].map((_, i) => <svg key={`full-${i}`} className="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>)}
                    {[...Array(emptyStars)].map((_, i) => <svg key={`empty-${i}`} className="w-4 h-4 text-gray-300 dark:text-gray-600" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>)}
                </div>
            );
        }

        function App() {
            const { useState, useEffect } = React;
            const [view, setView] = useState('search');
            const [isLoading, setIsLoading] = useState(false);
            const [theme, setTheme] = useState('light');
            const [tripData, setTripData] = useState(null);
            const [searchInput, setSearchInput] = useState('');
            const [daysInput, setDaysInput] = useState('');
            const [selectedInterests, setSelectedInterests] = useState([]);
            const [budgetLevel, setBudgetLevel] = useState('Mid-range');
            const [errorMessage, setErrorMessage] = useState('');
            const [expenses, setExpenses] = useState([]);
            const [totalBudget, setTotalBudget] = useState(0);
            const [numberOfPeople, setNumberOfPeople] = useState(1);
            const [expenseDesc, setExpenseDesc] = useState('');
            const [expenseAmount, setExpenseAmount] = useState('');
            const [activeTab, setActiveTab] = useState('itinerary');
            const [activeTool, setActiveTool] = useState('packing');
            const [foodSearch, setFoodSearch] = useState('');
            const [knowMoreModal, setKnowMoreModal] = useState(null);
            const [savedTripExists, setSavedTripExists] = useState(false);
            const [saveButtonText, setSaveButtonText] = useState('Save Trip');
            const [voices, setVoices] = useState([]);
            
            const cardColors = [
                "bg-sky-50 border-sky-200 dark:bg-sky-900/50 dark:border-sky-800",
                "bg-emerald-50 border-emerald-200 dark:bg-emerald-900/50 dark:border-emerald-800",
                "bg-rose-50 border-rose-200 dark:bg-rose-900/50 dark:border-rose-800",
                "bg-amber-50 border-amber-200 dark:bg-amber-900/50 dark:border-amber-800",
                "bg-violet-50 border-violet-200 dark:bg-violet-900/50 dark:border-violet-800",
                "bg-lime-50 border-lime-200 dark:bg-lime-900/50 dark:border-lime-800",
            ];

            useEffect(() => { 
                const savedTrip = localStorage.getItem('savedHack2TravelTrip'); 
                setSavedTripExists(!!savedTrip); 
                const handleVoicesChanged = () => setVoices(speechSynthesis.getVoices());
                speechSynthesis.onvoiceschanged = handleVoicesChanged;
                handleVoicesChanged();
            }, []);
            
            useEffect(() => {
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');
                setTheme(initialTheme);
                if (initialTheme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, []);

            const speak = (text) => {
                if (speechSynthesis.speaking) { return; }
                const utterance = new SpeechSynthesisUtterance(text);
                const malayalamVoice = voices.find(v => v.lang === 'ml-IN');
                if (malayalamVoice) { utterance.voice = malayalamVoice; }
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            };

            const toggleTheme = () => {
                const newTheme = theme === 'light' ? 'dark' : 'light';
                setTheme(newTheme);
                localStorage.setItem('theme', newTheme);
                if (newTheme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            };
            
            const handleInterestClick = (interest) => { setSelectedInterests(prev => prev.includes(interest) ? prev.filter(i => i !== interest) : [...prev, interest]); };
            
            const handleSearchSubmit = (e) => {
                e.preventDefault();
                const query = searchInput.trim().toLowerCase();
                const destination = destinations[query];
                if (destination && daysInput > 0) {
                    setIsLoading(true);
                    setErrorMessage('');
                    const dailyRates = { 'Budget': 2500, 'Mid-range': 6000, 'Luxury': 15000 };
                    const predictedBudget = dailyRates[budgetLevel] * parseInt(daysInput, 10);
                    setTotalBudget(predictedBudget);
                    setTimeout(() => {
                        setTripData({ ...destination, itinerary: generateItinerary(destination.activityPool, parseInt(daysInput, 10), selectedInterests) });
                        setActiveTab('itinerary');
                        setActiveTool('packing');
                        setView('destination');
                        setIsLoading(false);
                    }, 800);
                } else { setErrorMessage('Please enter "Kerala" and a valid number of days to begin.'); }
            };

            const handlePackageSelect = (pkg) => {
                setIsLoading(true);
                setDaysInput(pkg.days.toString());
                setSelectedInterests(pkg.interests);
                const dailyRates = { 'Budget': 2500, 'Mid-range': 6000, 'Luxury': 15000 };
                const predictedBudget = dailyRates[budgetLevel] * pkg.days;
                setTotalBudget(predictedBudget);
                 setTimeout(() => {
                    setTripData({ ...destinations['kerala'], itinerary: generateItinerary(destinations['kerala'].activityPool, pkg.days, pkg.interests) });
                    setActiveTab('itinerary');
                    setActiveTool('packing');
                    setView('destination');
                    setIsLoading(false);
                }, 800);
            };

            const handleBackToSearch = () => { setView('search'); setTripData(null); setSearchInput(''); setDaysInput(''); setSelectedInterests([]); setExpenses([]); setNumberOfPeople(1); setTotalBudget(0); setSaveButtonText('Save Trip'); };
            const addExpense = () => { const amount = parseFloat(expenseAmount); if (expenseDesc && !isNaN(amount) && amount > 0) { setExpenses([...expenses, { description: expenseDesc, amount }]); setExpenseDesc(''); setExpenseAmount(''); } };
            const deleteExpense = (indexToDelete) => { setExpenses(expenses.filter((_, index) => index !== indexToDelete)); };
            const totalAmountSpent = expenses.reduce((sum, exp) => sum + exp.amount, 0);
            const perPersonAmount = totalAmountSpent / (numberOfPeople || 1);
            const budgetProgress = totalBudget > 0 ? (totalAmountSpent / totalBudget) * 100 : 0;

            const handleSaveTrip = () => {
                const dataToSave = { tripData, daysInput, selectedInterests, budgetLevel, expenses, totalBudget, numberOfPeople, activeTab, activeTool };
                localStorage.setItem('savedHack2TravelTrip', JSON.stringify(dataToSave));
                setSaveButtonText('Trip Saved!');
                setSavedTripExists(true);
                setTimeout(() => setSaveButtonText('Save Trip'), 2000);
            };
            const handleLoadTrip = () => {
                const savedData = JSON.parse(localStorage.getItem('savedHack2TravelTrip'));
                if (savedData) {
                    setIsLoading(true);
                    setTimeout(() => {
                        setTripData(savedData.tripData);
                        setDaysInput(savedData.daysInput);
                        setSelectedInterests(savedData.selectedInterests);
                        setBudgetLevel(savedData.budgetLevel || 'Mid-range');
                        setExpenses(savedData.expenses || []);
                        setTotalBudget(savedData.totalBudget || 0);
                        setNumberOfPeople(savedData.numberOfPeople || 1);
                        setActiveTab(savedData.activeTab || 'itinerary');
                        setActiveTool(savedData.activeTool || 'packing');
                        setView('destination');
                        setIsLoading(false);
                    }, 800);
                }
            };
            const handleClearTrip = () => {
                localStorage.removeItem('savedHack2TravelTrip');
                setSavedTripExists(false);
            };
            
            const filteredFoods = tripData ? tripData.localFoods.filter(food =>
                food.name.toLowerCase().includes(foodSearch.toLowerCase()) ||
                food.description.toLowerCase().includes(foodSearch.toLowerCase())
            ) : [];

            return (
                <div className="min-h-screen flex flex-col bg-gray-50 dark:bg-black text-gray-800 dark:text-gray-200">
                    <style>{`
                        :root { --card-bg: white; --card-border: #e5e7eb; --text-primary: #1f2937; --text-secondary: #6b7280; }
                        .dark { --card-bg: #1f2937; --card-border: #374151; --text-primary: #f9fafb; --text-secondary: #9ca3af; }
                        
                        body { font-family: 'Inter', sans-serif; }
                        .hero-bg { background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://images.unsplash.com/photo-1602216056096-3b40cc0c9944?q=80&w=2070&auto=format&fit=crop'); background-size: cover; background-position: center; }
                        
                        @keyframes deal-in-animation {
                            from { opacity: 0; transform: translateY(100px) scale(0.6) rotate(10deg); }
                            to { opacity: 1; transform: translateY(0) scale(1) rotate(0deg); }
                        }
                        
                        @keyframes pulse { 0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(167, 139, 250, 0.7); } 50% { transform: scale(1.03); box-shadow: 0 0 0 10px rgba(167, 139, 250, 0); } }
                        
                        .initial-hidden { opacity: 0; }
                        .card-animation { animation: deal-in-animation 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }

                        @keyframes content-fade-in {
                            from { opacity: 0; transform: translateY(10px); }
                            to { opacity: 1; transform: translateY(0); }
                        }
                        .content-animation { animation: content-fade-in 0.5s ease-out forwards; }

                        .interest-tag.selected, .budget-btn.selected { background-color: #6366f1; color: white; }
                        .header-logo { height: 48px; width: 48px; margin-right: 12px; }
                        .app-title { font-family: 'Poppins', sans-serif; font-weight: 700; font-size: 1.75rem; background-image: linear-gradient(to right, #4f46e5, #a855f7); color: transparent; -webkit-background-clip: text; background-clip: text; }
                        .dark .app-title { background-image: linear-gradient(to right, #818cf8, #c084fc); }
                        
                        .tab-button { padding: 12px 16px; font-weight: 600; color: var(--text-secondary); border-bottom: 3px solid transparent; transition: all 0.2s; }
                        .tab-button.active { color: #4f46e5; border-bottom-color: #4f46e5; }
                        .dark .tab-button.active { color: #a5b4fc; border-bottom-color: #a5b4fc; }

                        .colored-card { border-width: 1px; transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; }
                        .colored-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
                        .dark .colored-card:hover { box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.2), 0 4px 6px -2px rgba(99, 102, 241, 0.1); }
                        
                        .custom-checkbox input[type="checkbox"] { display: none; }
                        .custom-checkbox label { cursor: pointer; display: flex; align-items: center; }
                        .custom-checkbox .checkbox-box { width: 20px; height: 20px; border: 2px solid #9ca3af; border-radius: 4px; display: flex; align-items: center; justify-content: center; transition: background-color 0.2s, border-color 0.2s; }
                        .custom-checkbox .checkbox-box svg { opacity: 0; transform: scale(0.5); transition: opacity 0.2s, transform 0.2s; }
                        .custom-checkbox input[type="checkbox"]:checked + label .checkbox-box { background-color: #6366f1; border-color: #6366f1; }
                        .custom-checkbox input[type="checkbox"]:checked + label .checkbox-box svg { opacity: 1; transform: scale(1); }
                        .custom-checkbox input[type="checkbox"]:checked + label .checkbox-label { text-decoration: line-through; color: #9ca3af; }
                        .dark .custom-checkbox input[type="checkbox"]:checked + label .checkbox-label { color: #6b7280; }
                    `}</style>
                    <header className="bg-white/80 dark:bg-gray-900/80 backdrop-blur-sm shadow-md sticky top-0 z-20">
                        <div className="container mx-auto px-6 py-3 flex justify-between items-center">
                            <div className="flex items-center">
                                <img src="https://i.imgur.com/Sb5E51w.png" alt="hack2travel Logo" className="header-logo" />
                                <span className="app-title">hack2travel</span>
                            </div>
                            <button onClick={toggleTheme} className="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                                {theme === 'light' ? <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" /></svg> : <svg className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" /></svg> }
                            </button>
                        </div>
                    </header>
                    <main className="flex-grow">
                        {isLoading ? <div className="h-[80vh] flex items-center justify-center"><LoadingSpinner /></div> : view === 'search' ? (
                            <section className="hero-bg text-white h-auto min-h-[80vh] py-16 flex flex-col justify-center items-center text-center p-6">
                                <div className="initial-hidden card-animation">
                                    <h2 className="text-4xl md:text-5xl font-bold mb-4 text-shadow-lg">Plan Your Perfect Kerala Trip</h2>
                                    <p className="text-lg md:text-xl mb-8 max-w-2xl">Enter "Kerala", select your interests, and tell us how long you're staying. We'll handle the rest!</p>
                                </div>
                                <form onSubmit={handleSearchSubmit} className="w-full max-w-xl flex flex-col gap-4 initial-hidden card-animation" style={{animationDelay: '0.2s'}}>
                                    <input type="text" value={searchInput} onChange={(e) => setSearchInput(e.target.value)} placeholder="Enter 'Kerala'" className="w-full p-4 text-gray-900 rounded-lg shadow-lg focus:ring-4 focus:ring-indigo-400 transition" required />
                                    <div className="bg-black/20 backdrop-blur-sm p-4 rounded-lg">
                                        <label className="block text-white text-center font-semibold mb-3">Select Your Interests</label>
                                        <div className="flex flex-wrap justify-center gap-2">{interests.map(interest => (<button key={interest} type="button" onClick={() => handleInterestClick(interest)} className={`interest-tag bg-white/20 hover:bg-white/40 text-white font-medium py-2 px-4 rounded-full transition-all duration-200 ${selectedInterests.includes(interest) ? 'selected' : ''}`}>{interest}</button>))}</div>
                                    </div>
                                    <div className="bg-black/20 backdrop-blur-sm p-4 rounded-lg">
                                        <label className="block text-white text-center font-semibold mb-3">Select Your Budget</label>
                                        <div className="flex justify-center gap-2">{['Budget', 'Mid-range', 'Luxury'].map(level => (<button key={level} type="button" onClick={() => setBudgetLevel(level)} className={`budget-btn bg-white/20 hover:bg-white/40 text-white font-medium py-2 px-5 rounded-full transition-all duration-200 ${budgetLevel === level ? 'selected' : ''}`}>{level}</button>))}</div>
                                    </div>
                                    <input type="number" value={daysInput} onChange={(e) => setDaysInput(e.target.value)} min="1" placeholder="Number of days" className="w-full p-4 text-gray-900 rounded-lg shadow-lg focus:ring-4 focus:ring-indigo-400 transition" required />
                                    <button type="submit" className="w-full p-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg shadow-lg hover:from-indigo-700 hover:to-purple-700 font-semibold text-lg flex items-center justify-center gap-2 transition-all transform hover:scale-105" style={{animation: 'pulse 2.5s infinite'}}>
                                        <span>Plan My Trip</span>
                                        <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                                    </button>
                                </form>
                                {errorMessage && <p className="text-red-400 mt-4 font-semibold">{errorMessage}</p>}
                                {savedTripExists && (
                                    <div className="mt-8 bg-white/10 backdrop-blur-sm p-4 rounded-lg flex items-center justify-between w-full max-w-xl initial-hidden card-animation" style={{animationDelay: '0.4s'}}>
                                        <div><p className="font-semibold">You have a saved trip.</p></div>
                                        <div className="flex gap-2">
                                            <button onClick={handleLoadTrip} className="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-semibold transition-colors">Load Trip</button>
                                            <button onClick={handleClearTrip} className="p-2 text-white hover:text-red-400" title="Clear Saved Trip"><svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
                                        </div>
                                    </div>
                                )}
                            </section>
                        ) : (
                            <section className="container mx-auto p-6">
                                <div className="flex justify-between items-center mb-6 initial-hidden card-animation">
                                    <button onClick={handleBackToSearch} className="inline-flex items-center px-4 py-2 border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 transition-colors">
                                        <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                                        New Search
                                    </button>
                                    <button onClick={handleSaveTrip} className={`px-4 py-2 text-sm font-medium rounded-md shadow-sm text-white transition-all ${saveButtonText === 'Trip Saved!' ? 'bg-green-500' : 'bg-blue-600 hover:bg-blue-700'}`}>
                                        {saveButtonText}
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-1 lg:grid-cols-5 gap-8 items-center initial-hidden card-animation" style={{ animationDelay: '0.1s' }}>
                                    <div className="lg:col-span-3 aspect-video shadow-2xl rounded-xl">
                                       <PhotoGallery images={tripData.images} />
                                    </div>
                                    <div className="lg:col-span-2"><h2 className="text-4xl font-bold">{tripData.name}</h2><p className="text-lg text-gray-700 dark:text-gray-300 mt-4">{tripData.description}</p></div>
                                </div>

                                <div className="mt-8 border-b border-gray-200 dark:border-gray-700 initial-hidden card-animation" style={{ animationDelay: '0.2s' }}>
                                    <nav className="flex -mb-px space-x-2 md:space-x-6 overflow-x-auto">
                                        {['itinerary', 'packages', 'activities', 'explore', 'tools', 'info'].map(tab => (
                                            <button key={tab} onClick={() => setActiveTab(tab)} className={`tab-button flex-shrink-0 ${activeTab === tab ? 'active' : ''}`}>{tab.charAt(0).toUpperCase() + tab.slice(1)}</button>
                                        ))}
                                    </nav>
                                </div>
                                
                                <div className="mt-8 content-animation" key={activeTab}>
                                    {activeTab === 'itinerary' && (
                                        <div>
                                            <h3 className="text-3xl font-bold mb-6 text-center">Your {daysInput}-Day Itinerary</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                {tripData.itinerary.map((item, index) => (
                                                    <div key={item.day} className={`colored-card rounded-xl p-6 flex flex-col ${cardColors[index % cardColors.length]}`} >
                                                        <div className="flex justify-between items-start">
                                                            <h4 className="font-bold text-xl text-gray-800 dark:text-white mb-3 flex-1">{item.day}</h4>
                                                            <a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.location)}`} target="_blank" rel="noopener noreferrer" className="p-1 text-indigo-500 hover:text-indigo-700 flex-shrink-0"><svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" /></svg></a>
                                                        </div>
                                                        <ul className="space-y-2 list-disc list-inside flex-grow text-gray-700 dark:text-gray-300 border-t border-black/10 dark:border-white/10 pt-3">{item.activities.map(act => <li key={act.text}>{act.text}</li>)}</ul>
                                                        <button onClick={() => setKnowMoreModal(tripData.locationDetails[item.location] || null)} className="mt-4 text-sm font-semibold text-indigo-600 dark:text-indigo-400 hover:underline">Know More</button>
                                                        <div className="text-gray-600 dark:text-gray-400">
                                                            <WeatherWidget location={item.location} />
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                     {activeTab === 'packages' && (
                                        <div>
                                            <h3 className="text-3xl font-bold mb-6 text-center">Recommended Tour Packages</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                                {tripData.tourPackages.map((pkg, index) => (
                                                    <div key={pkg.name} className={`colored-card rounded-xl p-6 flex flex-col text-center ${cardColors[index % cardColors.length]}`}>
                                                        <h4 className="font-bold text-xl text-gray-800 dark:text-white">{pkg.name}</h4>
                                                        <p className="text-gray-700 dark:text-gray-300 my-3 flex-grow">{pkg.description}</p>
                                                        <p className="font-semibold text-gray-600 dark:text-gray-400 mb-4">{pkg.days} Days</p>
                                                        <button onClick={() => handlePackageSelect(pkg)} className="mt-auto w-full p-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors">Plan This Trip</button>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {activeTab === 'activities' && (
                                        <div>
                                            <h3 className="text-3xl font-bold mb-6 text-center">Activities in Kerala</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                                {tripData.activities.map((activityCat, index) => (
                                                    <div key={activityCat.category} className={`colored-card rounded-xl p-6 ${cardColors[index % cardColors.length]}`}>
                                                        <h4 className="font-bold text-xl text-gray-800 dark:text-white mb-4 flex items-center gap-3"><span className="text-3xl">{activityCat.icon}</span> {activityCat.category}</h4>
                                                        <ul className="space-y-3">
                                                            {activityCat.list.map(item => (
                                                                <li key={item.name} className="p-3 bg-white/50 dark:bg-black/20 rounded-lg">
                                                                    <p className="font-semibold text-gray-800 dark:text-gray-200">{item.name}</p>
                                                                    <p className="text-sm text-gray-600 dark:text-gray-400">{item.location}</p>
                                                                </li>
                                                            ))}
                                                        </ul>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {activeTab === 'explore' && (
                                       <div className="space-y-12">
                                            <div><MapComponent places={[...tripData.attractions, ...tripData.restaurants, ...tripData.hiddenGems]} /></div>
                                            
                                            {[{title: 'Top Attractions', data: tripData.attractions}, {title: 'Top Restaurants', data: tripData.restaurants}, {title: 'Hidden Gems', data: tripData.hiddenGems}].map((section) => (
                                                <div key={section.title}>
                                                    <h3 className="text-3xl font-bold mb-6 text-center">{section.title}</h3>
                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        {section.data.map((item, itemIndex) => {
                                                            const avgRating = item.reviews && item.reviews.length > 0 ? (item.reviews.reduce((sum, rev) => sum + rev.rating, 0) / item.reviews.length).toFixed(1) : 0;
                                                            return (
                                                                <div key={item.name} className={`colored-card rounded-lg p-6 h-full flex flex-col`}>
                                                                    <div className="flex items-start space-x-4"><div className="text-4xl flex-shrink-0">{item.icon || (item.type && item.type.split(' ')[0])}</div><div className="flex-1"><h4 className="font-bold text-lg text-gray-800 dark:text-white">{item.name}</h4>{item.type && <p className="text-sm font-semibold text-gray-500 dark:text-gray-400">{item.type.split(' ').slice(1).join(' ')}</p>}<p className="mt-1 text-gray-700 dark:text-gray-300">{item.details}</p></div><a href={`https://www.google.com/maps/search/?api=1&query=${item.coords[0]},${item.coords[1]}`} target="_blank" rel="noopener noreferrer" className="p-2 text-indigo-500 hover:text-indigo-700 flex-shrink-0"><svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" /></svg></a></div>
                                                                    {item.reviews && item.reviews.length > 0 && (<div className="mt-4 pt-4 border-t border-black/10 dark:border-white/10 text-gray-600 dark:text-gray-400 flex items-center gap-2"><StarRating rating={avgRating} /><span className="text-sm font-semibold ">{avgRating}</span><span className="text-sm">({item.reviews.length} reviews)</span></div>)}
                                                                </div>
                                                            )
                                                        })}
                                                    </div>
                                                </div>
                                            ))}
                                            </div>
                                    )}
                                    {activeTab === 'tools' && (
                                        <div>
                                             <div className="flex justify-center gap-2 mb-8 border-b border-gray-200 dark:border-gray-700 pb-4">
                                                 {[ {id: 'packing', label: 'Packing List', icon: 'üß≥'}, {id: 'budget', label: 'Budget Planner', icon: 'üí∞'}, {id: 'language', label: 'Language Helper', icon: 'üó£Ô∏è'}, {id: 'food', label: 'Food Guide', icon: 'ü•ò'}, {id: 'festivals', label: 'Festival Tracker', icon: 'üéâ'} ].map(tool => (
                                                    <button key={tool.id} onClick={() => setActiveTool(tool.id)} className={`px-4 py-2 font-semibold rounded-lg transition-colors flex items-center gap-2 ${activeTool === tool.id ? 'bg-indigo-600 text-white' : 'bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600'}`}>
                                                        <span>{tool.icon}</span><span>{tool.label}</span>
                                                    </button>
                                                 ))}
                                             </div>
                                             <div className="content-animation" key={activeTool}>
                                                 {activeTool === 'packing' && (
                                                    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg"><h3 className="text-3xl font-bold mb-6 text-center pt-8">Smart Packing Checklist</h3><div className="p-8"><div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">{Object.entries(tripData.packingList).map(([category, items]) => (<div key={category}><h4 className="font-bold text-lg mb-3 text-indigo-700 dark:text-indigo-400">{category}</h4><ul className="space-y-3">{items.map(item => (<li key={item} className="custom-checkbox"><input type="checkbox" id={item.replace(/\s+/g, '-')} /><label htmlFor={item.replace(/\s+/g, '-')}><span className="checkbox-box mr-3"><svg className="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="3"><path strokeLinecap="round" strokeLinejoin="round" d="M5 13l4 4L19 7" /></svg></span><span className="checkbox-label transition-colors">{item}</span></label></li>))}</ul></div>))}</div></div></div>
                                                 )}
                                                 {activeTool === 'budget' && (
                                                     <div><h3 className="text-3xl font-bold mb-6 text-center">Trip Budget Planner</h3><div className="grid grid-cols-1 md:grid-cols-5 gap-8"><div className="md:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8"><h4 className="font-bold text-xl mb-4">Budget Overview</h4><div className="space-y-4"><div className="text-center bg-indigo-50 dark:bg-indigo-900/50 p-3 rounded-lg"><p className="text-sm text-indigo-800 dark:text-indigo-200">Suggested Budget for a <span className="font-bold">{budgetLevel}</span> trip:</p><p className="text-2xl font-bold text-indigo-600 dark:text-indigo-400">‚Çπ{totalBudget.toLocaleString('en-IN')}</p></div><label className="block text-sm font-medium mb-1">Set Your Total Budget (‚Çπ)</label><input type="number" value={totalBudget} onChange={e => setTotalBudget(parseFloat(e.target.value) || 0)} placeholder="e.g., 50000" className="w-full p-3 bg-gray-100 dark:bg-gray-800/50 border-gray-300 dark:border-gray-600 border rounded-lg focus:ring-2 focus:ring-indigo-500 transition" /><div><label className="block text-sm font-medium mb-1">Budget Usage</label><div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"><div className={`h-4 rounded-full transition-all duration-500 ${budgetProgress > 90 ? 'bg-red-500' : budgetProgress > 70 ? 'bg-amber-500' : 'bg-green-500'}`} style={{ width: `${Math.min(budgetProgress, 100)}%` }}></div></div></div><div className="border-t-2 border-gray-200 dark:border-gray-700 pt-4 space-y-2"><div className="flex justify-between font-semibold"><span>Spent:</span> <span>‚Çπ{totalAmountSpent.toFixed(2)}</span></div><div className={`flex justify-between font-bold text-lg ${totalBudget - totalAmountSpent < 0 ? 'text-red-500' : ''}`}><span>Remaining:</span> <span>‚Çπ{(totalBudget - totalAmountSpent).toFixed(2)}</span></div></div></div></div><div className="md:col-span-3 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8"><h4 className="font-bold text-xl mb-4">Log & Split Expenses</h4><div className="grid grid-cols-3 gap-4 mb-4"><input type="text" value={expenseDesc} onChange={(e) => setExpenseDesc(e.target.value)} placeholder="Expense (e.g., Dinner)" className="col-span-2 w-full p-3 bg-gray-100 dark:bg-gray-800/50 border-gray-300 dark:border-gray-600 border rounded-lg focus:ring-2 focus:ring-indigo-500 transition" /><input type="number" value={expenseAmount} onChange={(e) => setExpenseAmount(e.target.value)} placeholder="Amount (‚Çπ)" min="0" className="w-full p-3 bg-gray-100 dark:bg-gray-800/50 border-gray-300 dark:border-gray-600 border rounded-lg focus:ring-2 focus:ring-indigo-500 transition" /></div><button onClick={addExpense} className="w-full mb-4 p-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors">Add Expense</button><ul className="space-y-2 mb-4 h-32 overflow-y-auto pr-2">{expenses.length > 0 ? expenses.map((exp, index) => (<li key={index} className={`flex justify-between items-center p-2 rounded-md ${index % 2 === 0 ? 'bg-gray-50 dark:bg-gray-700/50' : ''}`}><span>{exp.description}</span><div className="flex items-center gap-4"><span className="font-semibold">‚Çπ{exp.amount.toFixed(2)}</span><button onClick={() => deleteExpense(index)} className="text-red-500 hover:text-red-700"><svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></li>)) : <div className="text-center text-gray-500 pt-8">No expenses added yet.</div>}</ul><div className="border-t-2 border-gray-200 dark:border-gray-700 pt-4"><div className="flex items-center gap-4"><label htmlFor="people-count" className="block text-sm font-medium">Split among:</label><input type="number" id="people-count" value={numberOfPeople} onChange={e => setNumberOfPeople(Math.max(1, parseInt(e.target.value, 10)))} min="1" className="w-24 p-2 bg-gray-100 dark:bg-gray-800/50 border-gray-300 dark:border-gray-600 border rounded-lg focus:ring-2 focus:ring-indigo-500 transition" /><div className="text-right flex-grow"><span className="font-bold text-lg text-indigo-600 dark:text-indigo-400">Per Person: <span>‚Çπ{perPersonAmount.toFixed(2)}</span></span></div></div></div></div></div></div>
                                                 )}
                                                 {activeTool === 'language' && (
                                                    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg"><h3 className="text-3xl font-bold mb-6 text-center pt-8">Language Helper (Malayalam)</h3><div className="p-8 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">{Object.entries(translations).map(([english, malayalam]) => (<div key={english} className="p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg shadow-sm flex justify-between items-center"><div ><p className="font-semibold">{english.charAt(0).toUpperCase() + english.slice(1)}</p><p className="text-indigo-600 dark:text-indigo-400">{malayalam}</p></div><button onClick={() => speak(malayalam)} className="p-2 text-indigo-500 hover:text-indigo-700"><svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z" /><path d="M5.5 4.5a.5.5 0 01.5-.5h2a.5.5 0 010 1h-2a.5.5 0 01-.5-.5zM6 6a.5.5 0 00-.5.5v2a.5.5 0 001 0V6.5A.5.5 0 006 6zM13 10a1 1 0 011-1h.5a.5.5 0 000-1H14a1 1 0 01-1-1V4a1 1 0 112 0v5a3 3 0 01-3 3z" /></svg></button></div>))}</div></div>
                                                 )}
                                                 {activeTool === 'food' && (
                                                    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg">
                                                        <h3 className="text-3xl font-bold mb-4 text-center pt-8">Local Food Guide</h3>
                                                        <div className="px-8 pb-4">
                                                            <div className="relative">
                                                                <input type="text" value={foodSearch} onChange={e => setFoodSearch(e.target.value)} placeholder="Search for a dish..." className="w-full p-3 pl-10 bg-gray-100 dark:bg-gray-800/50 border-gray-300 dark:border-gray-600 border rounded-lg focus:ring-2 focus:ring-indigo-500 transition" />
                                                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg className="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clipRule="evenodd" /></svg></div>
                                                            </div>
                                                        </div>
                                                        <div className="p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                            {filteredFoods.length > 0 ? filteredFoods.map((food, index) => (
                                                                <div key={food.name} className={`colored-card rounded-lg p-6 ${cardColors[index % cardColors.length]}`}>
                                                                    <h4 className="font-bold text-xl text-gray-800 dark:text-white">{food.name}</h4>
                                                                    <p className="text-sm font-semibold text-gray-500 dark:text-gray-400 mb-2">{food.type}</p>
                                                                    <p className="text-gray-700 dark:text-gray-300 mb-4">{food.description}</p>
                                                                    <div>
                                                                        <h5 className="font-semibold text-gray-800 dark:text-white mb-1">Ingredients:</h5>
                                                                        <ul className="list-disc list-inside text-sm text-gray-600 dark:text-gray-400">
                                                                            {food.ingredients.map(ing => <li key={ing}>{ing}</li>)}
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            )) : <div className="md:col-span-2 lg:col-span-3 text-center py-10 text-gray-500">No dishes found matching your search.</div>}
                                                        </div>
                                                    </div>
                                                 )}
                                                 {activeTool === 'festivals' && (
                                                    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg">
                                                        <h3 className="text-3xl font-bold mb-6 text-center pt-8">Festival Tracker</h3>
                                                        <div className="p-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                                                            {tripData.festivals.map((festival, index) => (
                                                                <div key={festival.name} className={`colored-card rounded-lg p-6 text-center ${cardColors[(index+2) % cardColors.length]}`}>
                                                                    <h4 className="font-bold text-2xl text-gray-800 dark:text-white">{festival.name}</h4>
                                                                    <p className="text-gray-600 dark:text-gray-300 italic my-2">"{festival.slogan}"</p>
                                                                    <p className="font-semibold text-indigo-600 dark:text-indigo-400 mb-3">{festival.time}</p>
                                                                    <p className="text-gray-700 dark:text-gray-400">{festival.places}</p>
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                 )}
                                             </div>
                                        </div>
                                    )}
                                    {activeTab === 'info' && (
                                        <div>
                                            <h3 className="text-3xl font-bold mb-6 text-center">Emergency Information</h3>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8">
                                                    <h4 className="font-bold text-xl mb-4">Important Numbers</h4>
                                                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4">{Object.entries(tripData.emergencyInfo).filter(([key]) => typeof tripData.emergencyInfo[key] === 'string').map(([service, number]) => (<div key={service} className="bg-red-50 dark:bg-red-900/20 p-4 rounded-lg text-center h-full flex flex-col justify-center"><p className="font-semibold capitalize text-red-800 dark:text-red-200">{service.replace(/([A-Z])/g, ' $1')}</p><p className="text-2xl font-bold text-red-600 dark:text-red-300">{number}</p></div>))}</div>
                                                </div>
                                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8">
                                                     <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                                                        <div><h4 className="font-bold text-lg mb-3 text-indigo-700 dark:text-indigo-400">Nearby Hospitals</h4><ul className="space-y-2">{tripData.emergencyInfo.hospitals.map(item => (<li key={item.name} className="flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded-md"><span>{item.name}</span><a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.name)}`} target="_blank" rel="noopener noreferrer" className="p-1 text-blue-500 hover:text-blue-700"><svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" /></svg></a></li>))}</ul></div>
                                                        <div><h4 className="font-bold text-lg mb-3 text-indigo-700 dark:text-indigo-400">Nearby Pharmacies</h4><ul className="space-y-2">{tripData.emergencyInfo.pharmacies.map(item => (<li key={item.name} className="flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded-md"><span>{item.name}</span><a href={`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.name)}`} target="_blank" rel="noopener noreferrer" className="p-1 text-blue-500 hover:text-blue-700"><svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" /></svg></a></li>))}</ul></div>
                                                     </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                                { knowMoreModal && (
                                    <div className="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50" onClick={() => setKnowMoreModal(null)}>
                                        <div className="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-8 max-w-lg w-full m-4" onClick={e => e.stopPropagation()}>
                                            <h3 className="text-2xl font-bold mb-4">Location Details</h3>
                                            <div className="space-y-3">
                                                <p><strong>Crowd Level:</strong> <span className="font-normal">{knowMoreModal.c}</span></p>
                                                <p><strong>Type:</strong> <span className="font-normal">{knowMoreModal.t}</span></p>
                                                <p><strong>Distance from Main City:</strong> <span className="font-normal">{knowMoreModal.d}</span></p>
                                                <p><strong>Amenities (Medical/Grocery):</strong> <span className={`font-semibold ${knowMoreModal.a ? 'text-green-600' : 'text-red-600'}`}>{knowMoreModal.a ? 'Readily Available' : 'Limited'}</span></p>
                                                <p><strong>Safety:</strong> <span className={`font-semibold ${knowMoreModal.s ? 'text-green-600' : 'text-amber-600'}`}>{knowMoreModal.s ? 'Generally Safe' : 'Be Cautious'}</span></p>
                                            </div>
                                            <button onClick={() => setKnowMoreModal(null)} className="mt-6 w-full p-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-semibold transition-colors">Close</button>
                                        </div>
                                    </div>
                                )}
                            </section>
                        )}
                    </main>
                    <footer className="bg-white dark:bg-gray-800 mt-auto border-t border-gray-200 dark:border-gray-700">
                        <div className="container mx-auto px-6 py-4 text-center text-gray-600 dark:text-gray-400">
                            <p>¬© {new Date().getFullYear()} hack2travel. All rights reserved.</p>
                        </div>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(<App />);
    </script>
</body>
</html>

